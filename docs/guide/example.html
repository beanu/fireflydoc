<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>示例 | 萤火钱包文档</title>
    <meta name="description" content="萤火钱包文档网站">
    
    
    <link rel="preload" href="/fireflydoc/assets/css/0.styles.f0812460.css" as="style"><link rel="preload" href="/fireflydoc/assets/js/app.6c9a8961.js" as="script"><link rel="preload" href="/fireflydoc/assets/js/11.db56b60a.js" as="script"><link rel="prefetch" href="/fireflydoc/assets/js/10.5174131d.js"><link rel="prefetch" href="/fireflydoc/assets/js/12.aededbf4.js"><link rel="prefetch" href="/fireflydoc/assets/js/13.8d86395b.js"><link rel="prefetch" href="/fireflydoc/assets/js/14.5295bd7a.js"><link rel="prefetch" href="/fireflydoc/assets/js/15.9ba6fc9c.js"><link rel="prefetch" href="/fireflydoc/assets/js/2.173a0891.js"><link rel="prefetch" href="/fireflydoc/assets/js/3.a285248c.js"><link rel="prefetch" href="/fireflydoc/assets/js/4.5d1a235f.js"><link rel="prefetch" href="/fireflydoc/assets/js/5.a3665182.js"><link rel="prefetch" href="/fireflydoc/assets/js/6.583b9b0d.js"><link rel="prefetch" href="/fireflydoc/assets/js/7.c08d4385.js"><link rel="prefetch" href="/fireflydoc/assets/js/8.7f59b51e.js"><link rel="prefetch" href="/fireflydoc/assets/js/9.215096bd.js">
    <link rel="stylesheet" href="/fireflydoc/assets/css/0.styles.f0812460.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fireflydoc/" class="home-link router-link-active"><!----> <span class="site-name">萤火钱包文档</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fireflydoc/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/fireflydoc/jsapi/" class="nav-link">JS API</a></div><div class="nav-item"><a href="/fireflydoc/urlschema/" class="nav-link">URL Schema</a></div><div class="nav-item"><a href="/fireflydoc/stellar/" class="nav-link">恒星基础</a></div><div class="nav-item"><a href="https://github.com/imloama/fireflywallet-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS SDK
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.stellarcn.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  恒星中文文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fireflydoc/guide/example.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fireflydoc/en/guide/example.html" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/fchainio/fireflydoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fireflydoc/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/fireflydoc/jsapi/" class="nav-link">JS API</a></div><div class="nav-item"><a href="/fireflydoc/urlschema/" class="nav-link">URL Schema</a></div><div class="nav-item"><a href="/fireflydoc/stellar/" class="nav-link">恒星基础</a></div><div class="nav-item"><a href="https://github.com/imloama/fireflywallet-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS SDK
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://docs.stellarcn.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  恒星中文文档
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fireflydoc/guide/example.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/fireflydoc/en/guide/example.html" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/fchainio/fireflydoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fireflydoc/guide/" class="sidebar-link">介绍</a></li><li><a href="/fireflydoc/guide/example.html" class="active sidebar-link">示例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#启动app开发者模式" class="sidebar-link">启动APP开发者模式</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#使用萤火钱包app调试" class="sidebar-link">使用萤火钱包APP调试</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#使用桌面设备调试" class="sidebar-link">使用桌面设备调试</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取钱包版本信息" class="sidebar-link">获取钱包版本信息</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取钱包os平台信息" class="sidebar-link">获取钱包OS平台信息</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取当前设备的uuid" class="sidebar-link">获取当前设备的UUID</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取钱包的语言设置" class="sidebar-link">获取钱包的语言设置</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取用户地址（id）" class="sidebar-link">获取用户地址（ID）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#获取用户余额（balance）" class="sidebar-link">获取用户余额（balance）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#支付功能（payment）" class="sidebar-link">支付功能（payment）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#路径支付功能（path-payment" class="sidebar-link">路径支付功能（path payment)</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#使用用户当前密钥签名（sign" class="sidebar-link">使用用户当前密钥签名（sign)</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#验证签名（validate" class="sidebar-link">验证签名（validate)</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#提请用户信任资产（trust）" class="sidebar-link">提请用户信任资产（trust）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#请求用户签署xdr（signxdr）" class="sidebar-link">请求用户签署XDR（signXDR）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#扫描二维码功能（scan）" class="sidebar-link">扫描二维码功能（scan）</a></li><li class="sidebar-sub-header"><a href="/fireflydoc/guide/example.html#分享功能（share" class="sidebar-link">分享功能（share)</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="示例"><a href="#示例" aria-hidden="true" class="header-anchor">#</a> 示例</h2> <p>下面的连接，需要在钱包中打开。
URL为https://t.cn/Re3xw6q
添加方法：打开萤火钱包APP中的『探索』，点击右上角的图标，再次点击加号，输入名称，添加上述地址即可。返回『探索』页面，点击打开。
源码见<a href="https://github.com/fchainio/firefly-examples/tree/master/dapp" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>页面在萤火钱包中打开后，萤火钱包会注入FFW对象，可以使用window.FFW访问。可以根据此判断网页是否是在萤火内开启。</p> <h2 id="启动app开发者模式"><a href="#启动app开发者模式" aria-hidden="true" class="header-anchor">#</a> 启动APP开发者模式</h2> <p>萤火钱包APP默认关闭了开发者模式，如果要开启，请打开&quot;我的&quot;-&quot;设置&quot;-&quot;关于&quot;，多次点击萤火图标，即可开启开发者模式</p> <h2 id="使用萤火钱包app调试"><a href="#使用萤火钱包app调试" aria-hidden="true" class="header-anchor">#</a> 使用萤火钱包APP调试</h2> <p>打开&quot;萤火钱包APP&quot;，打开&quot;探索&quot;页，在右上角打开&quot;+&quot;号按钮，填写名称和应用访问地址，即可在&quot;自定义应用&quot;栏看到添加的应用，可以点击图标打开运行</p> <h2 id="使用桌面设备调试"><a href="#使用桌面设备调试" aria-hidden="true" class="header-anchor">#</a> 使用桌面设备调试</h2> <p>Firefly桌面版本与移动版本功能一致，调试更加方便。除一些移动设备特定功能不能使用，如分享，扫描以外，等其它API均可进行测试。
使用方法：
点击导航栏『探索』，在自定义应用点击添加按钮。输入名称与应用地址后保存。
点击添加的DApp，会自动弹出<code>Chrome developer tools</code>。</p> <h2 id="获取钱包版本信息"><a href="#获取钱包版本信息" aria-hidden="true" class="header-anchor">#</a> 获取钱包版本信息</h2> <p>返回当前萤火钱包的版本信息，类型为字符串。如当前版本为 '2.1.8'。</p> <div class="language- extra-class"><pre class="language-text"><code>  window.FFW.version    
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>'2.1.8'
</code></pre></div><h2 id="获取钱包os平台信息"><a href="#获取钱包os平台信息" aria-hidden="true" class="header-anchor">#</a> 获取钱包OS平台信息</h2> <p>返回当前钱包所在设备的操作系统信息，类型为字符串，当前返回值为android或者ios。</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.platform
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>'android'
</code></pre></div><h2 id="获取当前设备的uuid"><a href="#获取当前设备的uuid" aria-hidden="true" class="header-anchor">#</a> 获取当前设备的UUID</h2> <p>返回当前钱包所在的设备的UUID进行SHA256运算后的数据，类型为字符串。</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.uuid
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>'01a0865f4c2687d90f70f32b01c1e258bfd7aa6c7ccc35339dfacd72f5018bb8'
</code></pre></div><h2 id="获取钱包的语言设置"><a href="#获取钱包的语言设置" aria-hidden="true" class="header-anchor">#</a> 获取钱包的语言设置</h2> <p>返回当前钱包使用的语言选项，类型为字符串。</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.locale
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>'zh_cn'
</code></pre></div><h2 id="获取用户地址（id）"><a href="#获取用户地址（id）" aria-hidden="true" class="header-anchor">#</a> 获取用户地址（ID）</h2> <p>返回当前用户的地址，类型为字符串，如GCENG5GLJ35GPJZQM3YJSFL3GMQ57MA5U6ZAAE6V4XIFVXFPY5MS5Q65</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.address
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>'GCENG5GLJ35GPJZQM3YJSFL3GMQ57MA5U6ZAAE6V4XIFVXFPY5MS5Q65'
</code></pre></div><h2 id="获取用户余额（balance）"><a href="#获取用户余额（balance）" aria-hidden="true" class="header-anchor">#</a> 获取用户余额（balance）</h2> <p>返回当前用户的资产信息。<code>balances(callback)</code>
恒星网络可以发行资产。因此用户可以拥有多种资产。使用此方法可以获取当前用户所有的资产信息。
此方法从钱包指定的horizon获取余额（balance）信息并返回。</p> <ul><li>参数说明</li> <li><code>callback</code>是balance执行后的回调函数。可以是函数名称或者是一个函数。</li> <li>https://www.stellar.org/developers/horizon/reference/endpoints/accounts-single.html</li> <li>在balance执行完毕后，<code>callback</code>将会接收一个对象，内容如下</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示查询成功，fail表示查询失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment">//Array类型。内容为用户的资产状态信息。</span>
     <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>代码示例</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.balances(function(response){
        if(response.code === 'fail'){
             console.log('error:' + response.message)  
             alert('查询失败！'+response.message)
        }else{
             console.log('query for balances successfully')
             $(&quot;#balances_data&quot;).text(JSON.stringify(response.data))
             alert('查询余额成功')
        }
});
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>[
    {
      &quot;balance&quot;: &quot;1.0000000&quot;,       //资产余额
      &quot;limit&quot;: &quot;707382697076.8900000&quot;,  //资产可持有的上限。通常在向用户发送时使用。
      &quot;asset_type&quot;: &quot;credit_alphanum4&quot;,   //资产类型，分别为credit_alphanum4和credit_alphanum12. 
      &quot;asset_code&quot;: &quot;XFF&quot;,        //资产代码
      &quot;asset_issuer&quot;: &quot;GAZEX2USUBMMWFRZFS77VDJYXUFLXI4ZGFPWX6TBNZCSTEQWNLFZMXFF&quot;   //资产发行方
    },
    {
      &quot;balance&quot;: &quot;1.9999900&quot;,   //资产余额
      &quot;asset_type&quot;: &quot;native&quot;       //native指代本地资产，即XLM
    }
]
</code></pre></div><h2 id="支付功能（payment）"><a href="#支付功能（payment）" aria-hidden="true" class="header-anchor">#</a> 支付功能（payment）</h2> <p><code>pay(data, callback)</code>
使用该方法，可以提请用户进行指定支付。
参数说明：
<code>data</code>是一个JSON，需要包含以下内容</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token punctuation">{</span>
    destination<span class="token punctuation">:</span> <span class="token string">'接收方地址'</span><span class="token punctuation">,</span>  <span class="token comment">//字符串，必须填写</span>
    code<span class="token punctuation">:</span> <span class="token string">'资产编码'</span><span class="token punctuation">,</span>           <span class="token comment">//字符串，必须填写</span>
    issuer<span class="token punctuation">:</span> <span class="token string">'资产发行方'</span><span class="token punctuation">,</span>     <span class="token comment">//字符串，在发送原生资产XLM时，可不填写。其它资产均需要填写。</span>
    amount<span class="token punctuation">:</span> <span class="token string">'资产发送数量'</span><span class="token punctuation">,</span> <span class="token comment">// number类型, 必须填写 </span>
    memo_type<span class="token punctuation">:</span> <span class="token string">'备注类型'</span><span class="token punctuation">,</span> <span class="token comment">//字符串，选填，可取值：NONE TEXT HASH ID RETURN。 </span>
    memo<span class="token punctuation">:</span> <span class="token string">'备注内容'</span>   <span class="token comment">//字符串，选填，当memo_type为NONE时，不需要填写，memo_type为其它值时，需要填写。</span>
   <span class="token punctuation">}</span>
</code></pre></div><p>关于<code>code</code>，<code>issuer</code>的概念，参见<a href="https://www.stellar.org/developers/guides/concepts/assets.html" target="_blank" rel="noopener noreferrer">stellar 官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，<a href="https://docs.stellarcn.org/developers/guides/concepts/assets.html" target="_blank" rel="noopener noreferrer">中文版<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。
关于 <code>memo_type</code>和<code>memo</code>的概念，参见<a href="https://www.stellar.org/developers/guides/concepts/transactions.html#memo" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，稍后会以汉语进行说明。
<code>callback</code> 是payment执行后的回调函数，可以是函数名称或者是一个函数。
在pay执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示支付成功，fail表示支付失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span><span class="token string">'返回结果数据'</span>     <span class="token comment">//object类型或null</span>
     <span class="token punctuation">}</span>
</code></pre></div><p>代码示例</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.pay({
         destination: 'GBFGPA6MELXHEKWPJW75LOMC4CHGHTZ67LOWUGTUUILMXMZZGFLTO3X7', 
         code: 'XFF', 
         issuer: 'GAZEX2USUBMMWFRZFS77VDJYXUFLXI4ZGFPWX6TBNZCSTEQWNLFZMXFF', 
         amount: 1, 
         memo_type: 'TEXT',  
         memo: 'Hello,FFW'
       }, function(response){
           if(response.code === 'fail'){
             console.log('error:' + response.message)  
             alert('支付失败！'+response.message)
           }else{
             console.log('pay success')
             alert('支付成功')
             //后续代码
           }
});
</code></pre></div><p><img src="https://static.oschina.net/uploads/space/2018/0806/162145_Uid5_109284.png" alt="调用界面"></p> <h2 id="路径支付功能（path-payment"><a href="#路径支付功能（path-payment" aria-hidden="true" class="header-anchor">#</a> 路径支付功能（path payment)</h2> <p>WIP...</p> <h2 id="使用用户当前密钥签名（sign"><a href="#使用用户当前密钥签名（sign" aria-hidden="true" class="header-anchor">#</a> 使用用户当前密钥签名（sign)</h2> <p><code>sign(data, callback)</code>
使用该方法可以对数据进行签名，可以用于权限验证，比如应用可以在执行某些需要验证用户身份的操作之前，提供一些数据让用户进行签名鉴权。可以用来做用户登录。
参数说明：
<code>data</code>是一个JSON格式的字符串。data 的长度限制（WIP）
<code>callback</code> 是sign执行后的回调函数，可以是函数名称或者是一个函数。
在<code>sign</code>执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示签名成功，fail表示签名失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span><span class="token string">'返回结果数据'</span>     <span class="token comment">//base64编码字符串类型或null</span>
     <span class="token punctuation">}</span>
</code></pre></div><p>代码示例</p> <div class="language- extra-class"><pre class="language-text"><code>let data = {name: 'firefly wallet dapp',desc:'the first hello in the world'}
data = JSON.stringify(data)
console.log('待签名的数据:' +data)
window.FFW.sign(data, function(response){
    if(response.code === 'fail'){
        console.log('error:' + response.message)  
    }else{
        console.log('success')
        console.log('签名后的结果：'+response.data)
    }
})
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>待签名的数据:{&quot;time&quot;:1533626528508,&quot;address&quot;:&quot;GACJFMOXTSE7QOL5HNYI2NIAQ4RDHZTGD6FNYK4P5THDVNWIKQDGOODU&quot;}
签名后的结果:4foYmY0Nrx1QPT5CfJEsJcYM0o40l4sHDo8aHJ0mHNq0ZY9Q7753FieHXBK3dJJ32+Lhw3UIJnzF2pplyo3LBg==

</code></pre></div><h2 id="验证签名（validate"><a href="#验证签名（validate" aria-hidden="true" class="header-anchor">#</a> 验证签名（validate)</h2> <p>WIP...</p> <h2 id="提请用户信任资产（trust）"><a href="#提请用户信任资产（trust）" aria-hidden="true" class="header-anchor">#</a> 提请用户信任资产（trust）</h2> <p><code>trust(code, issuer, callback)</code>
使用该方法，可以提请用户信任指定的资产。
参数说明：
<code>code</code>格式为字符串。内容为字母数字，即[a-z][A-Z][0-9]，长度限制为1-12字符。
<code>issuer</code>格式为字符串，内容为地址。如<code>GCKKUWHT3ILQWWKQ3MUOCAC7LRJNLCOES7SEI6TCQVGZD4GCULO2PGNU</code>。
<code>callback</code> 是trust执行后的回调函数，可以是函数名称或者是一个函数。
在<code>trust</code>执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <p>代码示例</p> <div class="language- extra-class"><pre class="language-text"><code>var code = 'XFF';
var issuer = 'GAZEX2USUBMMWFRZFS77VDJYXUFLXI4ZGFPWX6TBNZCSTEQWNLFZMXFF';
window.FFW.trust(code,issuer,function(response){
   if(response.code === 'fail'){
    console.log('error:' + response.message)  
       alert('授信失败')
    }else{
       console.log('trust success')
       alert('授信成功')
    }
})
</code></pre></div><p><img src="https://static.oschina.net/uploads/space/2018/0808/003018_3Kcb_109284.png" alt="调用界面"></p> <h2 id="请求用户签署xdr（signxdr）"><a href="#请求用户签署xdr（signxdr）" aria-hidden="true" class="header-anchor">#</a> 请求用户签署XDR（signXDR）</h2> <p><code>signXDR(data, message, callback)</code> <code>signXDR</code>是一个底层方法。当Firefly提供的API无法直接满足需求时，可以使用此方法进行高级操作。
使用前提：需要了解恒星底层SDK，能够手工构造Transaction封包。当构造并生成XDR格式的tranaction后，可以提请用户对Tx进行签名，签名后提交到网络。
参数说明：
<code>data</code> 字符串，构造的XDR格式的transaction。
<s><code>message</code> 字符串，用于告知用户此Tx的用途。</s> <code>callback</code> 是signXDR执行后的回调函数，可以是函数名称或者是一个函数。</p> <p>在<code>signXDR</code>执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示签署成功，fail表示签署失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span><span class="token string">'返回结果数据'</span>     <span class="token comment">//base64编码字符串类型或null</span>
     <span class="token punctuation">}</span>
</code></pre></div><p><em>代码示例</em></p> <div class="language- extra-class"><pre class="language-text"><code>var xdr = 'AAAAAEpng8wi7nIqz02/1bmC4I5jzz763WoadKIWy7M5MVc3AAAAZACHjkkAAAABAAAAAAAAAAAAAAABAAAAAAAAAAoAAAALaG9tZV9kb21haW4AAAAAAQAAABBodHRwOi8vZmNoYWluLmlvAAAAAAAAAAA='
 window.FFW.signXDR(xdr, &quot;更新主域名&quot;, function(response){
  if(response.code === 'fail'){
    console.log('error:' + response.message)  
    alert('签名失败！'+response.message)
  }else{
    console.log('签名成功,数据可以直接提交到Horizon')
    console.log(response.data)
  }
})
</code></pre></div><p><img src="https://static.oschina.net/uploads/space/2018/0808/005124_ty0v_109284.png" alt="调用界面"></p> <h2 id="扫描二维码功能（scan）"><a href="#扫描二维码功能（scan）" aria-hidden="true" class="header-anchor">#</a> 扫描二维码功能（scan）</h2> <p><code>scan(callback)</code>
使用该方法可以调用扫描功能，并获取二维码扫描结果。
参数说明：
<code>callback</code> 是scan执行后的回调函数，可以是函数名称或者是一个函数。
在<code>scan</code>执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示签署成功，fail表示签署失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span><span class="token string">'返回结果数据'</span>     <span class="token comment">//字符串类型或null</span>
     <span class="token punctuation">}</span>
</code></pre></div><p>代码示例</p> <div class="language- extra-class"><pre class="language-text"><code>window.FFW.scan(function(response){
  if(response.code === 'fail'){
    console.log('error:' + response.message)  
  }else{
     console.log('scan result:' + response.data)//response.data是二维码的扫描结果，字符串类型
  }
 })
  
</code></pre></div><h2 id="分享功能（share"><a href="#分享功能（share" aria-hidden="true" class="header-anchor">#</a> 分享功能（share)</h2> <p><code>share(options,callback)</code>
使用此方法，可以调用系统的分享功能。分享实现见<a href="https://github.com/EddyVerbruggen/SocialSharing-PhoneGap-Plugin" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>options</code>是一个JSON，需要包含以下内容</p> <p><code>分享功能</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token punctuation">{</span>
    message<span class="token punctuation">:</span> <span class="token string">'分享图片'</span><span class="token punctuation">,</span>  <span class="token comment">//字符串，必须填写</span>
    url<span class="token punctuation">:</span> <span class="token string">'https://fchain.io'</span><span class="token punctuation">,</span><span class="token comment">//字符串类型，选填，要分享的网址</span>
    files<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'图片内容'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">//数组，选填，支持远程图片地址或base64格式的图片等。如</span>
   <span class="token punctuation">}</span>
</code></pre></div><p><code>callback</code> 是share执行后的回调函数，可以是函数名称或者是一个函数。
在<code>share</code>执行完毕后，<code>callback</code>将会接收一个对象，内容如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span>  <span class="token string">'success | fail'</span><span class="token punctuation">,</span>     <span class="token comment">//success表示成功，fail表示失败。</span>
        message<span class="token punctuation">:</span><span class="token string">'提示信息 | 错误信息'</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>代码示例</p> <div class="language- extra-class"><pre class="language-text"><code>let options = {
   message: '分享图片',
   files: ['data:image/png;base64,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']
}
window.FFW.share(options,function(response){
  if(response.code === 'fail'){
    console.log('error:' + response.message)  
  }else{
    console.log('share success')
  }
})

</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/fchainio/fireflydoc/edit/master/src/guide/example.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-4-16 12:15:46</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/fireflydoc/guide/" class="prev router-link-active">
          介绍
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/fireflydoc/assets/js/app.6c9a8961.js" defer></script><script src="/fireflydoc/assets/js/11.db56b60a.js" defer></script>
  </body>
</html>
